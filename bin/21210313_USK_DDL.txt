
/* Drop Tables */

DROP TABLE REPRSNT_GOODS CASCADE CONSTRAINTS;
DROP TABLE ADI_FCLTY CASCADE CONSTRAINTS;
DROP TABLE REVIEW CASCADE CONSTRAINTS;
DROP TABLE ATTRACTION CASCADE CONSTRAINTS;
DROP TABLE AREA CASCADE CONSTRAINTS;
DROP TABLE BSN_TIME_SCHDUL CASCADE CONSTRAINTS;
DROP TABLE CMMN_CODE CASCADE CONSTRAINTS;
DROP TABLE HOTEL CASCADE CONSTRAINTS;
DROP TABLE SETLE CASCADE CONSTRAINTS;
DROP TABLE RESVE CASCADE CONSTRAINTS;
DROP TABLE MBER CASCADE CONSTRAINTS;
DROP TABLE TICKET CASCADE CONSTRAINTS;




/* Create Tables */

-- 부가시설
CREATE TABLE ADI_FCLTY
(
	-- 구역번호
	AREA_NO varchar2(2) NOT NULL,
	-- 시설번호
	FCLTY_NO varchar2(2) NOT NULL,
	-- 시설구분
	FCLTY_SE varchar2(2) NOT NULL,
	-- 시설구분명
	FCLTY_SE_NM varchar2(10) NOT NULL,
	-- 시설명
	FCLTY_NM varchar2(100) NOT NULL,
	-- 시설설명
	FCLTY_DC varchar2(500),
	-- 사진경로
	PHOTO_COURS varchar2(100),
	PRIMARY KEY (AREA_NO, FCLTY_NO)
);


-- 구역
CREATE TABLE AREA
(
	-- 구역번호
	AREA_NO varchar2(2) NOT NULL,
	-- 구역명
	AREA_NM varchar2(100) NOT NULL,
	PRIMARY KEY (AREA_NO)
);


-- 어트랙션
CREATE TABLE ATTRACTION
(
	-- 어트랙션번호
	ATTRACTION_NO varchar2(2) NOT NULL,
	-- 구역번호
	AREA_NO varchar2(2) NOT NULL,
	-- 어트랙션명
	ATTRACTION_NM varchar2(100) NOT NULL,
	-- 어트랙션유형
	ATTRACTION_TY varchar2(20),
	-- 어트랙션설명
	ATTRACTION_DC varchar2(500) NOT NULL,
	-- 사진경로
	PHOTO_COURS varchar2(100),
	-- 운행여부
	OPRAT_AT char NOT NULL,
	-- 운영시작시간
	OPER_BEGIN_TIME varchar2(6) NOT NULL,
	-- 운영종료시간
	OPER_END_TIME varchar2(6) NOT NULL,
	PRIMARY KEY (ATTRACTION_NO)
);


-- 영업시간일정
CREATE TABLE BSN_TIME_SCHDUL
(
	-- 달력
	CLDR varchar2(8) NOT NULL,
	-- 시간대
	TMZON varchar2(11),
	-- 이벤트
	EVENT varchar2(100),
	PRIMARY KEY (CLDR)
);


-- 공통코드
CREATE TABLE CMMN_CODE
(
	-- 공통코드
	COMMON_CODE varchar2(4) NOT NULL,
	-- 코드명
	CODE_NM varchar2(60) NOT NULL,
	-- 가격
	PC number,
	PRIMARY KEY (COMMON_CODE)
);


-- 호텔
CREATE TABLE HOTEL
(
	-- 호텔번호
	HOTEL_NO varchar2(1) NOT NULL,
	-- 호텔명
	HOTEL_NM varchar2(60),
	-- 호텔설명
	HOTEL_DC varchar2(500),
	-- 호텔전화번호
	HOTEL_TELNO varchar2(14),
	-- 호텔주소
	HOTEL_LQTX varchar2(100),
	-- 사진경로
	PHOTO_COURS varchar2(100),
	PRIMARY KEY (HOTEL_NO)
);


-- 회원
CREATE TABLE MBER
(
	-- 회원번호
	MBER_NO varchar2(5) NOT NULL,
	-- 회원아이디
	MBER_ID varchar2(20) NOT NULL UNIQUE,
	-- 비밀번호
	PASSWORD varchar2(20) NOT NULL,
	-- 회원명
	MBER_NM varchar2(60) NOT NULL,
	-- 이메일
	EMAIL varchar2(30) NOT NULL,
	-- 휴대전화번호
	MOBLPHON varchar2(14),
	-- 회원탈퇴여부
	MBER_SECSN_AT char NOT NULL,
	PRIMARY KEY (MBER_NO)
);


-- 대표상품
CREATE TABLE REPRSNT_GOODS
(
	-- 구역번호
	AREA_NO varchar2(2) NOT NULL,
	-- 시설번호
	FCLTY_NO varchar2(2) NOT NULL,
	-- 상품번호
	GOODS_NO varchar2(1) NOT NULL,
	-- 사진경로
	PHOTO_COURS varchar2(100),
	PRIMARY KEY (AREA_NO, FCLTY_NO, GOODS_NO)
);


-- 예약
CREATE TABLE RESVE
(
	-- 예약번호
	RESVE_NO varchar2(6) NOT NULL,
	-- 회원번호
	MBER_NO varchar2(5) NOT NULL,
	-- 티켓번호
	TICKET_NO varchar2(2) NOT NULL,
	-- 공통코드
	CMMN_CODE varchar2(4) NOT NULL,
	-- 예약일
	RESVE_DE varchar2(8) NOT NULL,
	-- 입장일
	ENTNC_DE varchar2(8) NOT NULL,
	-- 결제여부
	SETLE_AT char NOT NULL,
	PRIMARY KEY (RESVE_NO)
);


-- 리뷰
CREATE TABLE REVIEW
(
	-- 어트랙션번호
	ATTRACTION_NO varchar2(2) NOT NULL,
	-- 예약번호
	RESVE_NO varchar2(6) NOT NULL,
	-- 발급번호
	ISSU_NO varchar2(6) NOT NULL,
	-- 내용
	CN varchar2(300) NOT NULL,
	-- 별점
	RATING number NOT NULL,
	-- 사진경로
	PHOTO_COURS varchar2(100),
	-- 등록일
	REGIST_DE varchar2(8),
	PRIMARY KEY (ATTRACTION_NO, RESVE_NO, ISSU_NO)
);


-- 결제
CREATE TABLE SETLE
(
	-- 예약번호
	RESVE_NO varchar2(6) NOT NULL,
	-- 발급번호
	ISSU_NO varchar2(6) NOT NULL,
	-- 결제금액
	SETLE_AMOUNT number NOT NULL,
	-- 결제일시
	SETLE_DT date NOT NULL,
	-- 취소신청여부
	CANCL_REQST_AT char,
	-- 취소일시
	COMPT_DT date,
	-- 결제취소완료여부
	CANCDE_COMPT_AT char,
	PRIMARY KEY (RESVE_NO, ISSU_NO)
);


-- 티켓
CREATE TABLE TICKET
(
	-- 티켓번호
	TICKET_NO varchar2(2) NOT NULL,
	-- 유효기간
	VALID_PD number NOT NULL,
	-- 티켓명
	TICKET_NM varchar2(100) NOT NULL,
	-- 티켓설명
	TICKET_DC varchar2(500),
	-- 사진경로
	PHOTO_COURS varchar2(100),
	-- 공통코드
	CMMN_CODE varchar2(4) NOT NULL,
	PRIMARY KEY (TICKET_NO)
);



/* Create Foreign Keys */

ALTER TABLE REPRSNT_GOODS
	ADD FOREIGN KEY (AREA_NO, FCLTY_NO)
	REFERENCES ADI_FCLTY (AREA_NO, FCLTY_NO)
;


ALTER TABLE ADI_FCLTY
	ADD FOREIGN KEY (AREA_NO)
	REFERENCES AREA (AREA_NO)
;


ALTER TABLE ATTRACTION
	ADD FOREIGN KEY (AREA_NO)
	REFERENCES AREA (AREA_NO)
;


ALTER TABLE REVIEW
	ADD FOREIGN KEY (ATTRACTION_NO)
	REFERENCES ATTRACTION (ATTRACTION_NO)
;


ALTER TABLE RESVE
	ADD FOREIGN KEY (MBER_NO)
	REFERENCES MBER (MBER_NO)
;


ALTER TABLE SETLE
	ADD FOREIGN KEY (RESVE_NO)
	REFERENCES RESVE (RESVE_NO)
;


ALTER TABLE REVIEW
	ADD FOREIGN KEY (RESVE_NO, ISSU_NO)
	REFERENCES SETLE (RESVE_NO, ISSU_NO)
;


ALTER TABLE RESVE
	ADD FOREIGN KEY (TICKET_NO)
	REFERENCES TICKET (TICKET_NO)
;



/* Comments */

COMMENT ON TABLE ADI_FCLTY IS '부가시설';
COMMENT ON COLUMN ADI_FCLTY.AREA_NO IS '구역번호';
COMMENT ON COLUMN ADI_FCLTY.FCLTY_NO IS '시설번호';
COMMENT ON COLUMN ADI_FCLTY.FCLTY_SE IS '시설구분';
COMMENT ON COLUMN ADI_FCLTY.FCLTY_SE_NM IS '시설구분명';
COMMENT ON COLUMN ADI_FCLTY.FCLTY_NM IS '시설명';
COMMENT ON COLUMN ADI_FCLTY.FCLTY_DC IS '시설설명';
COMMENT ON COLUMN ADI_FCLTY.PHOTO_COURS IS '사진경로';
COMMENT ON TABLE AREA IS '구역';
COMMENT ON COLUMN AREA.AREA_NO IS '구역번호';
COMMENT ON COLUMN AREA.AREA_NM IS '구역명';
COMMENT ON TABLE ATTRACTION IS '어트랙션';
COMMENT ON COLUMN ATTRACTION.ATTRACTION_NO IS '어트랙션번호';
COMMENT ON COLUMN ATTRACTION.AREA_NO IS '구역번호';
COMMENT ON COLUMN ATTRACTION.ATTRACTION_NM IS '어트랙션명';
COMMENT ON COLUMN ATTRACTION.ATTRACTION_TY IS '어트랙션유형';
COMMENT ON COLUMN ATTRACTION.ATTRACTION_DC IS '어트랙션설명';
COMMENT ON COLUMN ATTRACTION.PHOTO_COURS IS '사진경로';
COMMENT ON COLUMN ATTRACTION.OPRAT_AT IS '운행여부';
COMMENT ON COLUMN ATTRACTION.OPER_BEGIN_TIME IS '운영시작시간';
COMMENT ON COLUMN ATTRACTION.OPER_END_TIME IS '운영종료시간';
COMMENT ON TABLE BSN_TIME_SCHDUL IS '영업시간일정';
COMMENT ON COLUMN BSN_TIME_SCHDUL.CLDR IS '달력';
COMMENT ON COLUMN BSN_TIME_SCHDUL.TMZON IS '시간대';
COMMENT ON COLUMN BSN_TIME_SCHDUL.EVENT IS '이벤트';
COMMENT ON TABLE CMMN_CODE IS '공통코드';
COMMENT ON COLUMN CMMN_CODE.COMMON_CODE IS '공통코드';
COMMENT ON COLUMN CMMN_CODE.CODE_NM IS '코드명';
COMMENT ON COLUMN CMMN_CODE.PC IS '가격';
COMMENT ON TABLE HOTEL IS '호텔';
COMMENT ON COLUMN HOTEL.HOTEL_NO IS '호텔번호';
COMMENT ON COLUMN HOTEL.HOTEL_NM IS '호텔명';
COMMENT ON COLUMN HOTEL.HOTEL_DC IS '호텔설명';
COMMENT ON COLUMN HOTEL.HOTEL_TELNO IS '호텔전화번호';
COMMENT ON COLUMN HOTEL.HOTEL_LQTX IS '호텔주소';
COMMENT ON COLUMN HOTEL.PHOTO_COURS IS '사진경로';
COMMENT ON TABLE MBER IS '회원';
COMMENT ON COLUMN MBER.MBER_NO IS '회원번호';
COMMENT ON COLUMN MBER.MBER_ID IS '회원아이디';
COMMENT ON COLUMN MBER.PASSWORD IS '비밀번호';
COMMENT ON COLUMN MBER.MBER_NM IS '회원명';
COMMENT ON COLUMN MBER.EMAIL IS '이메일';
COMMENT ON COLUMN MBER.MOBLPHON IS '휴대전화번호';
COMMENT ON TABLE REPRSNT_GOODS IS '대표상품';
COMMENT ON COLUMN REPRSNT_GOODS.AREA_NO IS '구역번호';
COMMENT ON COLUMN REPRSNT_GOODS.FCLTY_NO IS '시설번호';
COMMENT ON COLUMN REPRSNT_GOODS.GOODS_NO IS '상품번호';
COMMENT ON COLUMN REPRSNT_GOODS.PHOTO_COURS IS '사진경로';
COMMENT ON TABLE RESVE IS '예약';
COMMENT ON COLUMN RESVE.RESVE_NO IS '예약번호';
COMMENT ON COLUMN RESVE.MBER_NO IS '회원번호';
COMMENT ON COLUMN RESVE.TICKET_NO IS '티켓번호';
COMMENT ON COLUMN RESVE.CMMN_CODE IS '공통코드';
COMMENT ON COLUMN RESVE.RESVE_DE IS '예약일';
COMMENT ON COLUMN RESVE.ENTNC_DE IS '입장일';
COMMENT ON COLUMN RESVE.SETLE_AT IS '결제여부';
COMMENT ON TABLE REVIEW IS '리뷰';
COMMENT ON COLUMN REVIEW.ATTRACTION_NO IS '어트랙션번호';
COMMENT ON COLUMN REVIEW.RESVE_NO IS '예약번호';
COMMENT ON COLUMN REVIEW.ISSU_NO IS '발급번호';
COMMENT ON COLUMN REVIEW.CN IS '내용';
COMMENT ON COLUMN REVIEW.RATING IS '별점';
COMMENT ON COLUMN REVIEW.PHOTO_COURS IS '사진경로';
COMMENT ON TABLE SETLE IS '결제';
COMMENT ON COLUMN SETLE.RESVE_NO IS '예약번호';
COMMENT ON COLUMN SETLE.ISSU_NO IS '발급번호';
COMMENT ON COLUMN SETLE.SETLE_AMOUNT IS '결제금액';
COMMENT ON COLUMN SETLE.SETLE_DT IS '결제일시';
COMMENT ON COLUMN SETLE.CANCL_REQST_AT IS '취소신청여부';
COMMENT ON COLUMN SETLE.COMPT_DT IS '취소일시';
COMMENT ON COLUMN SETLE.CANCDE_COMPT_AT IS '결제취소완료여부';
COMMENT ON TABLE TICKET IS '티켓';
COMMENT ON COLUMN TICKET.TICKET_NO IS '티켓번호';
COMMENT ON COLUMN TICKET.VALID_PD IS '유효기간';
COMMENT ON COLUMN TICKET.TICKET_NM IS '티켓명';
COMMENT ON COLUMN TICKET.TICKET_DC IS '티켓설명';
COMMENT ON COLUMN TICKET.PHOTO_COURS IS '사진경로';
COMMENT ON COLUMN TICKET.CMMN_CODE IS '공통코드';







-- 시퀀스 번호 부여

-- 시퀀스 삭제
DROP SEQUENCE MBER_NO_SEQ;
DROP SEQUENCE RESVE_NO_SEQ;
DROP SEQUENCE ISSU_NO_SEQ;

-- 시퀀스 생성
-- 회원번호 시퀀스
CREATE SEQUENCE MBER_NO_SEQ
START WITH 1
INCREMENT BY 1;
NOCYCLE;

-- 예약번호 시퀀스
CREATE SEQUENCE RESVE_NO_SEQ
START WITH 100000
INCREMENT BY 1
NOCYCLE;

-- 발급번호 시퀀스
CREATE SEQUENCE ISSU_NO_SEQ
START WITH 200000
INCREMENT BY 1
NOCYCLE;


COMMIT;